const ValidateWrapper = artifacts.require("ValidateWrapper");

let {
    assertRejects
} = require('./utilities.js');

contract('Validate', (accounts) => {
    const [operator, depositor] = accounts
    
    const zeroHash32 = "0x0000000000000000000000000000000000000000000000000000000000000000"

    const short_sig = "0x7226EB9E77E58C172BDC510C76E15B4BF9A81EF"
    const too_long_sig = "0x7226EB9E77E58C172BDC510C76E15B4BF9A81EF38D91D54173DC79D135A80F5167226EB9E77E58C172BDC510C76E15B4BF9A81EF38D91D54173DC79D135A80F5167226EB9E77E58C172BDC510C76E15B4BF9A81EF38D91D54173DC79D135A80F5167226EB9E77E58C172BDC510C76E15B4BF9A81EF38D91D54173DC79D135A80F5162BDC510C76E15B4BF9A81EF38D91D54173DC79D135A80F5167226EB9E77E58C172BDC510C76E15B4BF9A82BDC510C76E15B4BF9A81EF38D91D54173DC79D135A80F5167226EB9E77E58C172BDC510C76E15B4BF9A82BDC510C76E15B4BF9A81EF38D91D54173DC79D135A80F5167226EB9E77E58C172BDC510C76E15B4BF9A8"

    zeroSig195 = "0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
    zeroSig260 = "0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"

    before(async () => {
        validator = await ValidateWrapper.new();
    })

    describe('checkSigs', () => {

        it('Fail: sig length not a multiple of 65', async () => {
            await assertRejects(validator.checkSigs(zeroHash32, zeroHash32, 0, zeroHash32))
        })

        it('Fail: sig length greater than 260', async () => {
            await assertRejects(validator.checkSigs(zeroHash32, zeroHash32, 0, too_long_sig))
        })

        it('Fail: signatures not correct', async () => {
            res = await validator.checkSigs.call(zeroHash32, zeroHash32, 0, zeroSig195)
            assert.equal(res, false)
        })

        // TODO - Get Validator to pass


    })

})
